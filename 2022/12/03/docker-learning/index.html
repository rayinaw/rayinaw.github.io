<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="canonical" href="https://rayinaw.github.io/2022/12/03/docker-learning/">
  <link rel="icon" href="https://i.pinimg.com/564x/07/87/e7/0787e75ed249720cdb85f6918c609f61.jpg">
  
  <title>Một bản ghi chép nhỏ về Docker | Rayinaw</title>
  <meta name="author" content="Rayinaw">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="index,follow">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="format-detection" content="telphone=no, email=no">
  
    <meta name="keywords" content="Docker">
  
  <meta name="description" content="Docker Command LineThao tác với mỗi lần chạy:123docker run busybox:1.24 echo &quot;hello world!&quot;docker run busybox:1.24 ls &#x2F;  -i và -t flag:Flag -i dùng để mở một tương tác với container, giữ cho">
<meta property="og:type" content="article">
<meta property="og:title" content="Một bản ghi chép nhỏ về Docker">
<meta property="og:url" content="https://rayinaw.github.io/2022/12/03/docker-learning/index.html">
<meta property="og:site_name" content="Rayinaw">
<meta property="og:description" content="Docker Command LineThao tác với mỗi lần chạy:123docker run busybox:1.24 echo &quot;hello world!&quot;docker run busybox:1.24 ls &#x2F;  -i và -t flag:Flag -i dùng để mở một tương tác với container, giữ cho">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.pinimg.com/564x/07/87/e7/0787e75ed249720cdb85f6918c609f61.jpg">
<meta property="article:published_time" content="2022-12-02T18:13:09.000Z">
<meta property="article:modified_time" content="2022-12-05T10:06:31.773Z">
<meta property="article:author" content="Rayinaw">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.pinimg.com/564x/07/87/e7/0787e75ed249720cdb85f6918c609f61.jpg">
  
  <!-- 站点验证相关 -->
  
    
      <meta name="google-site-verification" content="aI3yWWy1IiiYpszN7ZglYDMHV2_A2mRNPujhnK6q8uA">
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all">
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)">
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night.min.css" media="all">
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all">
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all">
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css">
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/bg.webp');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="Rayinaw" type="application/rss+xml">
</head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                                
                                                    
                                                        
                                                                <li>
                                                                    <a href="/">
                                                                        <i class="fa fa-home"></i>Trang chủ
                                                                    </a>
                                                                </li>
                                                                
                                                                    
                                                        
                                                                <li>
                                                                    <a href="/archives/">
                                                                        <i class="fa fa-book"></i>Kho lưu trữ
                                                                    </a>
                                                                </li>
                                                                
                                                                    
                                                        
                                                                <li>
                                                                    <a href="/about/">
                                                                        <i class="fa fa-paper-plane"></i>Về mình
                                                                    </a>
                                                                </li>
                                                                
                                                                    
                                                                        
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo">
                        <a href="/">
                            Rayinaw
                        </a>
                    </div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>
                            Rayinaw
                        </h2> <br>
                        <span>Nơi mình ghi chú lại những thứ đã học.</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="https://rayinaw.github.io/2022/12/03/docker-learning/">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">Một bản ghi chép nhỏ về Docker</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2022-12-02T18:13:09.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2022-12-03</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> Tác giả <span itemprop="name">Rayinaw</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~17.56K
                    
                    từ
                </li>
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>Bài viết này được chỉnh sửa lần cuối vào <time datetime="1670234791773"></time> trước, và có thể cần cập nhật。</p></div>
            </div>
            
            
            
                <div class="kratos-post-inner-toc toc-div-class">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-Command-Line"><span class="toc-number">1.</span> <span class="toc-text">Docker Command Line</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Thao-tac-voi-moi-lan-chay"><span class="toc-number">1.1.</span> <span class="toc-text">Thao tác với mỗi lần chạy:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#i-va-t-flag"><span class="toc-number">1.2.</span> <span class="toc-text">-i và -t flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-container-va-d-flag"><span class="toc-number">1.3.</span> <span class="toc-text">Docker container và -d flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%93name-flag"><span class="toc-number">1.4.</span> <span class="toc-text">–name flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#p-flag"><span class="toc-number">1.5.</span> <span class="toc-text">-p flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-log"><span class="toc-number">1.6.</span> <span class="toc-text">Docker log:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-pull"><span class="toc-number">1.7.</span> <span class="toc-text">Docker pull:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-commit"><span class="toc-number">1.8.</span> <span class="toc-text">Docker commit:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-build-command"><span class="toc-number">1.9.</span> <span class="toc-text">Docker build command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-inspect"><span class="toc-number">1.10.</span> <span class="toc-text">Docker inspect:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Image-va-Container"><span class="toc-number">1.11.</span> <span class="toc-text">Gỡ Image và Container:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Go-container"><span class="toc-number">1.11.1.</span> <span class="toc-text">Gỡ container:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Go-image"><span class="toc-number">1.11.2.</span> <span class="toc-text">Gỡ image:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-Container%E2%80%99s-Filesystem"><span class="toc-number">2.</span> <span class="toc-text">Docker Container’s Filesystem</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-images-va-layers"><span class="toc-number">2.1.</span> <span class="toc-text">Docker images và layers:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-container-va-writable-layer"><span class="toc-number">2.2.</span> <span class="toc-text">Docker container và writable layer:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cach-build-mot-Docker-image"><span class="toc-number">3.</span> <span class="toc-text">Cách build một Docker image:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-Docker-Images-by-using-Docker-Commit-Command"><span class="toc-number">3.1.</span> <span class="toc-text">Build Docker Images by using Docker Commit Command:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-Docker-Images-by-writing-DockerFile"><span class="toc-number">3.2.</span> <span class="toc-text">Build Docker Images by writing DockerFile:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile-la-gi"><span class="toc-number">3.2.1.</span> <span class="toc-text">Dockerfile là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Viet-mot-Dockerfile"><span class="toc-number">3.2.2.</span> <span class="toc-text">Viết một Dockerfile:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-RUN"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">Câu lệnh RUN:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-CMD"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">Câu lệnh CMD:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-cache"><span class="toc-number">3.2.2.3.</span> <span class="toc-text">Docker cache:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-COPY"><span class="toc-number">3.2.2.4.</span> <span class="toc-text">Câu lệnh COPY:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-ADD"><span class="toc-number">3.2.2.5.</span> <span class="toc-text">Câu lệnh ADD:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-WORKDIR"><span class="toc-number">3.2.2.6.</span> <span class="toc-text">Câu lệnh WORKDIR:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Xay-dung-Flask-web-don-gian-qua-Dockerfile"><span class="toc-number">3.2.2.7.</span> <span class="toc-text">Xây dựng Flask web đơn giản qua Dockerfile:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-Container-Links"><span class="toc-number">3.2.2.8.</span> <span class="toc-text">Docker Container Links:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-compose"><span class="toc-number">3.2.2.9.</span> <span class="toc-text">Docker compose</span></a></li></ol></li></ol></li></ol></li></ol>
                </div>
            
            <hr>
            <div itemprop="articleBody"><h1 id="Docker-Command-Line"><a href="#Docker-Command-Line" class="headerlink" title="Docker Command Line"></a>Docker Command Line</h1><h2 id="Thao-tac-voi-moi-lan-chay"><a href="#Thao-tac-voi-moi-lan-chay" class="headerlink" title="Thao tác với mỗi lần chạy:"></a>Thao tác với mỗi lần chạy:</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run busybox:1.24 echo &quot;hello world!&quot;</span><br><span class="line"></span><br><span class="line">docker run busybox:1.24 ls /</span><br></pre></td></tr></table></figure>

<h2 id="i-va-t-flag"><a href="#i-va-t-flag" class="headerlink" title="-i và -t flag:"></a>-i và -t flag:</h2><p>Flag -i dùng để mở một tương tác với container, giữ cho nó tiếp tục được mở để thực thi những tác vụ tiếp.<br>Flag -t dùng để tạo một pseudo-TTY(TTY tương tự như shell command trong linux), có nghĩa là tạo một shell của image rồi gắn vào terminal của mình.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -i -t busybox:1.24</span><br><span class="line">hay</span><br><span class="line">docker run -it busybox:1.24</span><br><span class="line">Kết quả:</span><br><span class="line">&gt; docker run -it busybox:1.24</span><br><span class="line">/ # ls</span><br><span class="line">bin   dev   etc   home  proc  root  sys   tmp   usr   var</span><br></pre></td></tr></table></figure>
<h2 id="Docker-container-va-d-flag"><a href="#Docker-container-va-d-flag" class="headerlink" title="Docker container và -d flag:"></a>Docker container và -d flag:</h2><p>Khi chạy một cách bình thường, nó sẽ thực thi lệnh trực tiếp trên terminal của chúng ta (run container in foreground). Nhưng nếu chúng ta muốn nó không chạy trên terminal mà chạy ở trong container (run container in background).<br>Ví dụ khi chạy lệnh sleep 1000:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Không chạy với tag -d:</span><br><span class="line">docker run  busybox:1.24 sleep 1000</span><br><span class="line">nó sẽ sleep trực tiếp trên terminal(mở terminal mới đi bro :P)</span><br><span class="line">Chạy với tag -d:</span><br><span class="line">docker run -d busybox:1.24 sleep 1000</span><br><span class="line">&gt; docker ps</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND        CREATED         STATUS         PORTS     NAMES</span><br><span class="line">4b69615931bb   busybox:1.24   &quot;sleep 1000&quot;   7 seconds ago   Up 6 seconds             eloquent_newton</span><br></pre></td></tr></table></figure>
<p>Để xem container đang chạy gõ <code>docker ps</code>(chạy trong background hoặc trên terminal), với container đã dừng gõ <code>docker ps -a</code>.<br>Để không lưu lại container khi kết thúc docker container chúng ta dùng tag –rm, khi đó nếu quy trình kết thúc, docker sẽ tự động xóa container mà không lưu vào <code>docker ps -a</code>.</p>
<h2 id="–name-flag"><a href="#–name-flag" class="headerlink" title="–name flag:"></a>–name flag:</h2><p>Đặt tên cho container mỗi lần chạy.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name hello_world busybox:1.24</span><br></pre></td></tr></table></figure>

<h2 id="p-flag"><a href="#p-flag" class="headerlink" title="-p flag:"></a>-p flag:</h2><p><code>-p host_port:container_port</code> : map cổng của container sang cổng máy thật. Chúng ta có thể map nhiều cặp port một lần bằng cách viết liên tiếp những cặp đó <code>-p 8888:8080 80:4444</code>.<br>Ví dụ với tomcat server, tomcat là một open source web server thực thi Java servlet. Tomcat image này chạy ở port 8080:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -p 8888:8080 tomcat:8.0</span><br><span class="line">Đợi một lát để nó pull tomcat:8.0 về.</span><br><span class="line">Sau khi tải xong truy cập http://localhost:8888/ trên browser. Tomcat đã chạy trên port 8888.</span><br><span class="line">Mình sẽ giải thích một chút:</span><br><span class="line">- Tomcat này là một container (xem như là một máy ảo cho dễ hình dung nhưng hầu như không phải nhé ^^), nó chạy trên port 8080 của máy chủ tomcat này.</span><br><span class="line">- Sau khi map qua cổng của localhost, cổng 8888 bây giờ sẽ như là cổng 8080 của máy chủ tomcat vậy.</span><br></pre></td></tr></table></figure>

<h2 id="Docker-log"><a href="#Docker-log" class="headerlink" title="Docker log:"></a>Docker log:</h2><p>Khi chạy một server qua terminal, nhật kí sẽ được ghi lại trực tiếp ở trên terminal. Khi chạy server qua container background để xem nhật kí của server chúng ta sử dụng câu lệnh <code>docker logs</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker run -it -d -p 8888:8080 tomcat:8.0</span><br><span class="line">4cc4583095b59189adaa0dc202944d5cdd5968df403584a84b26d6e57c585bd7</span><br><span class="line">pwn@DESKTOP-AC6UABE:pts/3-&gt;/home/pwn (0)</span><br><span class="line">&gt; docker logs 4cc4583095b59189adaa0dc202944d5cdd5968df403584a84b26d6e57c585bd7</span><br><span class="line">Using CATALINA_BASE:   /usr/local/tomcat</span><br><span class="line">Using CATALINA_HOME:   /usr/local/tomcat</span><br><span class="line">Using CATALINA_TMPDIR: /usr/local/tomcat/temp</span><br><span class="line">Using JRE_HOME:        /docker-java-home/jre</span><br><span class="line">......phần log ở dưới dài nên mình cắt......</span><br><span class="line">Hoặc lấy id từ docker ps rồi docker logs &lt;id&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Docker-pull"><a href="#Docker-pull" class="headerlink" title="Docker pull:"></a>Docker pull:</h2><p>Câu lệnh này dùng để lấy image từ trên hub của docker về. Ví dụ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:lastest</span><br><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>

<h2 id="Docker-commit"><a href="#Docker-commit" class="headerlink" title="Docker commit:"></a>Docker commit:</h2><p>Lệnh <code>docker commit</code> dùng để lưu những thay đổi trong file system của một Docker container vào image mới.<br>Syntax: <code>docker commit container_id repository_name:tag</code></p>
<h2 id="Docker-build-command"><a href="#Docker-build-command" class="headerlink" title="Docker build command"></a>Docker build command</h2><p>Câu lệnh <code>docker build</code> dùng để build một image từ một Dockerfile và context (nơi chứa những thứ như file php, java,… cần dùng để build). Hai thứ này được chứa trong cùng một folder, chúng ta gắn URL hoặc path để chỉ cho docker biết nơi chứa 2 cái này.<br>Systax:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build [OPTIONS] PATH</span><br><span class="line">Ví dụ:</span><br><span class="line">docker build -t image_name .</span><br></pre></td></tr></table></figure>
<ul>
<li>-t flag dùng để đặt tên cho image.</li>
<li>Dấu <code>.</code> để nói cho docker biết là tìm Dockerfile ở thư mục hiện tại, đây là path dẫn đến Dockerfile.</li>
</ul>
<h2 id="Docker-inspect"><a href="#Docker-inspect" class="headerlink" title="Docker inspect:"></a>Docker inspect:</h2><p>Mô tả thông tin low level của một container hay image.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker run -d busybox:1.24 sleep 100</span><br><span class="line">0c06e0155702fcb6dc7969eac63f68d74f5781dbc6960461ee88dc3c15942ea9</span><br><span class="line">pwn@DESKTOP-AC6UABE:pts/4-&gt;/home/pwn (0)</span><br><span class="line">&gt; docker inspect 0c06e0155702fcb6dc7969eac63f68d74f5781dbc6960461ee88dc3c15942ea9</span><br></pre></td></tr></table></figure>

<h2 id="Go-Image-va-Container"><a href="#Go-Image-va-Container" class="headerlink" title="Gỡ Image và Container:"></a>Gỡ Image và Container:</h2><h3 id="Go-container"><a href="#Go-container" class="headerlink" title="Gỡ container:"></a>Gỡ container:</h3><ul>
<li>Đầu tiên phải dừng container đang chạy: <code>docker stop &lt;id container&gt;</code></li>
<li>Gõ <code>docker ps -a</code> để xem container đã dừng.</li>
<li><code>docker rm -f &lt;id container đã dừng&gt;</code>, -f flag ở đây là cờ bắt buộc gỡ, nên xài để gỡ thuận tiện hơn.</li>
</ul>
<h3 id="Go-image"><a href="#Go-image" class="headerlink" title="Gỡ image:"></a>Gỡ image:</h3><ul>
<li><code>docker rmi &lt;tên image&gt;</code></li>
</ul>
<h1 id="Docker-Container’s-Filesystem"><a href="#Docker-Container’s-Filesystem" class="headerlink" title="Docker Container’s Filesystem"></a>Docker Container’s Filesystem</h1><h2 id="Docker-images-va-layers"><a href="#Docker-images-va-layers" class="headerlink" title="Docker images và layers:"></a>Docker images và layers:</h2><p>Một Docker images được xây dựng từ những layer. Mỗi layer đại diện cho mỗi lệnh trong Dockerfile, hay khi chạy lệnh bằng cách build thông qua Docker Commint Command ở phần sau.<br>Mỗi câu lệnh có thay đổi file của một container đều tạo ra một layer mới. Để dễ hình dung chúng ta cùng đi qua ví dụ sau(Lấy từ docs.docker.com):</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">18.04</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> org.opencontainers.image.authors=<span class="string">&quot;org@example.com&quot;</span></span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> make /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">rm</span> -r <span class="variable">$HOME</span>/.cache</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> python /app/app.py</span></span><br></pre></td></tr></table></figure>
<p>Khi chạy file trên, nó sẽ tạo ra một Docker image mới có cấu hình theo các câu lệnh được chạy ở file trên. Câu lệnh LABEL không liên quan đến file hệ thống. Câu lệnh COPY thêm file ở thư mục chứa Dockerfile vào thư mục &#x2F;app của container. Tuy nhiên nó chỉ COPY trong quá trình chạy, để viết thay đổi đó vào layer của một image mới chúng ta cần chạy lệnh <code>RUN make /app</code>, khi này một layer mới mới được tạo. <code>RUN rm -r $HOME/.cache</code> gỡ thư mục cache, câu lệnh RUN này sẽ tạo ra một layer mới. Câu lệnh CMD cuối cùng chỉ để chạy command python khi container đang chạy và không tạo layer mới.</p>
<p>Để xem các layers của một image chúng ta dùng lệnh <code>docker image history &lt;id&gt;</code></p>
<h2 id="Docker-container-va-writable-layer"><a href="#Docker-container-va-writable-layer" class="headerlink" title="Docker container và writable layer:"></a>Docker container và writable layer:</h2><p>Docker container được tạo từ những docker image chỉ đọc hay không thay đổi được. Một docker container được tạo từ một image sẽ có thêm một lớp ở trên, lớp này được gọi là <code>writable layer</code>hay <code>container layer</code>. Mọi thay đổi trong container này sẽ được lưu vào lớp này.</p>
<p>Khi nghiên cứu tới đây, mình có một thắc mắc là như đã nói, khi tạo một container việc thay đổi trong container này chỉ thay đổi lớp writable, rồi một image là không thay đổi được vậy thì tại sao chúng ta có thể thay đổi file hệ thống khi chạy container?. Theo mình hiểu thì nó như này:</p>
<ul>
<li>Khi chúng ta tạo một container, nó như là một máy mới được tạo ra vậy, chúng ta có thể thay đổi các file, folder trong máy mới này. Nó sẽ không ảnh hưởng gì đến các image cả vì nó riêng biệt mà.</li>
<li>Thế rồi writable đó để làm gì? Khi thay đổi một container chạy từ một image rồi lưu lại thành một image mới, người ta sẽ lưu lại quy trình theo từng bước khiến file hệ thống bị thay đổi để tạo quá trình build image mới này có trình tự, và chắc cũng dễ dàng hơn. Và khi này những bước thay đổi đó sẽ được lưu xuống lớp writable, nếu chúng ta commit thay đổi này, những cái thay đổi thực hiện ghi lại trong lớp writable này sẽ được lưu lại theo những layer mới xếp chồng lên những layer của image cũ.</li>
</ul>
<h1 id="Cach-build-mot-Docker-image"><a href="#Cach-build-mot-Docker-image" class="headerlink" title="Cách build một Docker image:"></a>Cách build một Docker image:</h1><p>Có hai cách để build một docker image:</p>
<ul>
<li>Commit những cái đã build, thay đổi trong một Docker container vào một image mới.</li>
<li>Viết một Dockerfile.<br>Bây giờ chúng ta cùng đi cụ thể vào từng cách để build một docker image.</li>
</ul>
<h2 id="Build-Docker-Images-by-using-Docker-Commit-Command"><a href="#Build-Docker-Images-by-using-Docker-Commit-Command" class="headerlink" title="Build Docker Images by using Docker Commit Command:"></a>Build Docker Images by using Docker Commit Command:</h2><p>Giả sử chúng ta chúng ta có một base image là một debian (hệ điều hành tương tự linux), khi run image này nó không có Git command. Bây giờ để thuận tiện hơn chúng ta tạo một image mới có cài sẵn Git dựa trên debian image kia để chúng ta không phải cài lại Git mỗi lần chạy. Khi đó chúng ta có ba bước để thực hiện như sau:</p>
<ul>
<li><ol>
<li>Tạo một container từ base image</li>
</ol>
</li>
<li><ol start="2">
<li>Install Git pakage trong container.</li>
</ol>
</li>
<li><ol start="3">
<li>Commit thay đổi trong container đã làm.<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pull và chạy debian</span></span><br><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -it debian:jessie</span></span><br><span class="line"><span class="comment"># Cài Git cho container này</span></span><br><span class="line">apt-get update &amp;&amp; apt-get install --force-yes git</span><br><span class="line"><span class="comment"># Commit thay đổi, gõ &quot;docker ps -a&quot; để lấy id của container này.</span></span><br><span class="line">docker commit ba638bca3016 rayinaw/debian:update</span><br><span class="line"><span class="comment"># Trả về sha256:3e6332e9ae0a1597a25d213bf42b0592e3291969259d631c3eacc893f4735171</span></span><br><span class="line">Gõ docker images để thấy một image mới đã được tạo. Size nó lớn hơn debian cũ <span class="number">100</span> mb, là dung lượng của git.</span><br><span class="line">Bây giờ chạy để test.</span><br><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -it rayinaw/debian:update</span></span><br><span class="line">Gõ git trong terminal của debian chúng ta tạo, git đã được cài vào image mới thành công.</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h2 id="Build-Docker-Images-by-writing-DockerFile"><a href="#Build-Docker-Images-by-writing-DockerFile" class="headerlink" title="Build Docker Images by writing DockerFile:"></a>Build Docker Images by writing DockerFile:</h2><h3 id="Dockerfile-la-gi"><a href="#Dockerfile-la-gi" class="headerlink" title="Dockerfile là gì?"></a>Dockerfile là gì?</h3><p>Dockerfile là một file văn bản chứa những lệnh user cung cấp để build các image một cách tự động từ Dockerfile. Tên của Dockerfile phải là <code>Dockerfile</code> với D viết hoa ở đầu.<br>Mỗi lệnh trong Dockerfile sẽ tạo một image layer mới đối với image này. Các lệnh sẽ chỉ định điều cần làm khi building image.<br>Khi building image, Docker sẽ thực hiện quy trình tương tự như việc chúng ta build bằng commit command. Docker sẽ build lần lượt từng layer, khi build xong ở trong lớp writable container, nó sẽ viết xuống image mới, sau đó remove container đó, rồi lần lượt theo trình tự đó cho đến khi build đủ các layer trong Dockerfile. Việc viết xuống image mình không biết nó lưu ở đâu, nếu muốn tìm hiểu các bạn có thể tìm hiểu thêm về Docker daemon.</p>
<h3 id="Viet-mot-Dockerfile"><a href="#Viet-mot-Dockerfile" class="headerlink" title="Viết một Dockerfile:"></a>Viết một Dockerfile:</h3><p>Câu lệnh đầu tiên trong <code>Dockerfile</code> là câu lệnh <code>FROM</code> (viết hoa để phân biệt với from arguments), dùng để chỉ định base image.</p>
<h4 id="Cau-lenh-RUN"><a href="#Cau-lenh-RUN" class="headerlink" title="Câu lệnh RUN:"></a>Câu lệnh RUN:</h4><ul>
<li>Dùng để chỉ định câu lệnh thực thi khi chạy base image.</li>
<li>Câu lệnh RUN sẽ thực thi câu lệnh trong writable layer của container, sau đó commit container xuống image mới.</li>
<li>Image mới này sẽ được sử dụng cho bước tiếp theo trong Dockerfile. Vì vậy mỗi lần RUN lệnh, nó sẽ tạo ra một image layer mới.<br>Ví dụ tương tự như cách build qua Docker commit:<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Đặt tên file là Dockerfile nhé.</span></span><br><span class="line"><span class="comment"># Lưu ý phiên bản ubuntu tạo phải được hỗ trợ, nếu không khi chạy lệnh update nó sẽ báo lỗi. Mình chưa biết fix nên không nói rõ nhé :).</span></span><br><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y git</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y vim</span></span><br></pre></td></tr></table></figure>
Bây giờ truy cập vào folder chứa Dockerfile rồi gõ lệnh <code>docker build -t ubuntu:own .</code></li>
</ul>
<p>Viết gọn các câu lệnh trên:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="language-bash">git \</span></span><br><span class="line"><span class="language-bash">vim</span></span><br></pre></td></tr></table></figure>
<h4 id="Cau-lenh-CMD"><a href="#Cau-lenh-CMD" class="headerlink" title="Câu lệnh CMD:"></a>Câu lệnh CMD:</h4><p>Khác với RUN, câu lệnh CMD sẽ không thực thi trong quá trình build image, nó chỉ thực thi khi khởi chạy container của image đó. Cái này nhìn ví dụ là dễ hiểu nhất:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get -y update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y git</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y vim</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;/&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<p>Chạy <code>docker build -t test .</code> để build image. Bây giờ chạy <code>docker run test</code> nó sẽ thực thi lệnh bên trong container này. Nó tương ứng với lúc chúng ta chạy lệnh <code>docker run test ls /</code>.<br>Nếu chúng ta chạy lệnh trực tiếp trên command line như <code>docker run test echo &quot;hello world&quot;</code> thì nó chỉ thực thi lệnh này và bỏ qua lệnh được viết ở trong Dockerfile.</p>
<h4 id="Docker-cache"><a href="#Docker-cache" class="headerlink" title="Docker cache:"></a>Docker cache:</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get -y update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y git</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y vim</span></span><br></pre></td></tr></table></figure>
<p>Nếu chúng ta build Dockerfile trên từ lần thứ 2 trở đi nó sẽ build nhanh hơn lần đầu tiên, bởi vì nó sử dụng lại layer đã build. Cái này liên quan đến docker cache. Mỗi layer riêng lẻ build ở trong mỗi lần build image, nó đều được ghi lại ở docker cache để sử dụng lại (riêng lẻ luôn chứ không phải sử dụng theo từng image).</p>
<p>Ví dụ:<br>Build image 1:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span>          <span class="comment"># --&gt; cache</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get -y update      <span class="comment"># --&gt; cache</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y git <span class="comment"># --&gt; cache</span></span></span><br></pre></td></tr></table></figure>
<p>Build image 2:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span>          <span class="comment"># --&gt; reuse</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get -y update      <span class="comment"># --&gt; reuse</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y vim <span class="comment"># --&gt; Câu lệnh này khác và layer tương ứng với câu lệnh này chưa được tạo nên sẽ thực hiện tạo layer mới và đương nhiên sẽ cache lại.</span></span></span><br></pre></td></tr></table></figure>
<p>Để không cache lại, chúng ta có thể sử dụng cờ <code>--no-cache=true</code>, mà cờ này hơi phế nhỉ, xài làm gì :).<br><code>docker build -t test . --no-cache=true</code></p>
<h4 id="Cau-lenh-COPY"><a href="#Cau-lenh-COPY" class="headerlink" title="Câu lệnh COPY:"></a>Câu lệnh COPY:</h4><p>Dùng để copy file hay thư mục từ build context (nơi chứa Dockerfile và những file cần thiết) vào file hệ thống của container. Ví dụ:<br>Nội dung Dockerfile:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get -y update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y vim</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> abc.txt /src/abc.txt</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;/src/abc.txt&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<p>Cùng thư mục với Dockerfile, tạo một file abc.txt ghi nội dung gì đó để test~</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t addfile .</span><br><span class="line">&gt; docker run addfile</span><br><span class="line">abc.txt file ne</span><br></pre></td></tr></table></figure>
<p>File abc.txt đã được copy vào thư mục src của container.</p>
<h4 id="Cau-lenh-ADD"><a href="#Cau-lenh-ADD" class="headerlink" title="Câu lệnh ADD:"></a>Câu lệnh ADD:</h4><p>Câu lệnh này gần như tương tự với câu lệnh COPY, điểm khác ở đây là ADD không chỉ copy từ context mà còn có thể download từ internet và copy vào container.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADD https://example.com/big.tar.xz /usr/src/things/</span><br></pre></td></tr></table></figure>
<p>ADD cũng có thể tự động giải nén file được tại về với một vài định dạng được hỗ trợ.</p>
<h4 id="Cau-lenh-WORKDIR"><a href="#Cau-lenh-WORKDIR" class="headerlink" title="Câu lệnh WORKDIR:"></a>Câu lệnh WORKDIR:</h4><p>Câu lệnh này dùng để tạo folder chỉ định và truy cập đến folder đó. <code>WORKDIR /app</code></p>
<h4 id="Xay-dung-Flask-web-don-gian-qua-Dockerfile"><a href="#Xay-dung-Flask-web-don-gian-qua-Dockerfile" class="headerlink" title="Xây dựng Flask web đơn giản qua Dockerfile:"></a>Xây dựng Flask web đơn giản qua Dockerfile:</h4><p><code>Python image</code>: Python image là một image được xây dựng dựa trên base image là <code>Alpine Linux</code>. Trong <code>Alpine Linux</code> này người ta sẽ cài python compiler vào. Cái này là trả lời thắc mắc cho việc tại sao python là compile mà lại có workdir các kiểu ~</p>
<p>Đầu tiên tạo thư mục app. Trong thư mục này sẽ chứa Dockerfile và một thư mục khác chứa file app.py, đặt là app luôn cho dễ nhé.<br>File app.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;hello world!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ = <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">        app.run(host = <span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Nội dung Dockerfile:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.8-alpine</span><br><span class="line">RUN pip install Flask==2.0.2</span><br><span class="line">WORKDIR /app</span><br><span class="line">COPY app /app</span><br><span class="line">CMD [&quot;python&quot;, &quot;app.py&quot;]</span><br></pre></td></tr></table></figure>

<p>Build image: <code>docker build -t flaskweb .</code><br>Chạy web: <code>docker run -d -p 5000:5000 flaskweb</code><br>Bây giờ trên browser gõ <a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost:5000/">http://localhost:5000</a> để truy cập web vừa chạy.</p>
<h4 id="Docker-Container-Links"><a href="#Docker-Container-Links" class="headerlink" title="Docker Container Links:"></a>Docker Container Links:</h4><p>Container links cho phép các container tìm ra nhau và trao đổi thông tin một cách bảo mật với nhau.<br>Khi set up một cái link, chúng ta tạo ra một ống dẫn giữa source container và recipient container. Recipient container có thể truy cập, lấy dữ liệu và thêm dữ liệu từ source container.<br>Links được thành lập bằng cách sử dụng container name. Lợi ích của việc này là chúng ta có thể thấy một cách rõ ràng hơn, không cần phải thông qua localhost.<br>Ví dụ xây dựng một web app từ flask và redis (api để lưu trữ dữ liệu):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cây thư mục như sau:</span><br><span class="line">Dockerfile      </span><br><span class="line">app       --------&gt;app.py</span><br><span class="line">               |</span><br><span class="line">               ---&gt;templates-----&gt;index.html </span><br></pre></td></tr></table></figure>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>simple service<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key&quot;</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">key</span> &#125;&#125;&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cache_value&quot;</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">cahe_value</span> &#125;&#125;&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;load&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;save&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">default_key = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">cache = redis.StrictRedis(host=<span class="string">&#x27;redis&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">cache.<span class="built_in">set</span>(default_key, <span class="string">&quot;one&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key = default_key</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> request.form:</span><br><span class="line">        key = request.form[<span class="string">&#x27;form&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span> <span class="keyword">and</span> request.form[<span class="string">&#x27;submit&#x27;</span>] == <span class="string">&#x27;save&#x27;</span>:</span><br><span class="line">        cache.<span class="built_in">set</span>(key, request.form[<span class="string">&#x27;cache_value&#x27;</span>])</span><br><span class="line">    cache_value = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> cache.get(key):</span><br><span class="line">        cache_value=cache.get(<span class="string">&#x27;key&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, key=key, cache_value=cache_value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.8-alpine</span><br><span class="line">RUN pip install Flask==2.0.2 redis==2.10.5</span><br><span class="line">WORKDIR /app</span><br><span class="line">COPY app /app</span><br><span class="line">CMD [&quot;python&quot;, &quot;app.py&quot;]</span><br></pre></td></tr></table></figure>

<p>Pull và khởi chạy redis: <code>docker run -d --name redis redis:3.2.0</code><br>Build image: <code>docker build -t dockerapp:v0.1 .</code><br>Khởi chạy image và link với redis: <code>docker run -d -p 5000:5000 --link redis dockerapp:v0.1</code></p>
<h4 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker compose"></a>Docker compose</h4><p>Các thuộc tín trong docker compose:</p>
<ul>
<li>version: chỉ ra phiên bản docker-compose đã sử dụng.</li>
<li>services: thiết lập các services(containers) muốn cài đặt và chạy.</li>
<li>image: chỉ ra image được sử dụng trong lúc tạo ra container.</li>
<li>build: dùng để tạo container.</li>
<li>ports: thiết lập ports chạy tại máy host và trong container.</li>
<li>restart: tự động khởi chạy khi container bị tắt.</li>
<li>environment: thiết lập biến môi trường ( thường sử dụng trong lúc config các thông số của db).</li>
<li>depends_on: chỉ ra sự phụ thuộc. Tức là services nào phải được cài đặt và chạy trước thì service được config tại đó mới được chạy.</li>
<li>volumes: dùng để mount hai thư mục trên host và container với nhau.</li>
</ul>
<p>Cũng như ví dụ ở trên, thay vì chúng ta pull, build image rồi khởi chạy rườm rà. Chúng ta có thể viết một <code>docker compose</code> rồi khởi chạy chỉ với một câu lệnh <code>docker-compose up</code>. Docker compose file cần tuân thủ nghiêm ngặt thụt lề, mỗi lần thụt là 2 khoảng trắng.<br>File name: docker-compose.yml, nó phải nằm chung thư mục với Dockerfile.</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">dockerapp:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:3.2.0</span></span><br></pre></td></tr></table></figure>
<p>Khởi chạy gõ <code>docker-compose up</code> hoặc thêm cờ -d <code>docker-compose up -d</code> để treo trong container.<br>Docker compose sẽ không build lại image nếu image đó đã tồn tại, vì vậy khi ta thay đổi một vài lệnh trong Dockerfile docker-compose vẫn lấy image cũ để thao tác. Để build lại một image mới, chúng ta cần sử dụng lệnh <code>docker-compose build</code>.</p>
</div>
        </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> Chia sẻ</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "https://rayinaw.github.io/2022/12/03/docker-learning/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "https://rayinaw.github.io/2022/12/03/docker-learning/";
            const title         = "「Một bản ghi chép nhỏ về Docker」";
            const excerpt       = `Docker Command LineThao tác với mỗi lần chạy:123docker run busybox:1.24 echo &quot;hello world!&quot;docker run busyb...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Docker/" rel="tag">Docker</a>
                </div>
                <div class="pull-date">
                    <time datetime="2022-12-05T10:06:31.773Z" itemprop="dateModified">Lần chỉnh sửa cuối cùng：2022-12-05</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" Khái niệm cơ bản về HTTP request smuggling với HTTP/1.1" href="/2022/11/30/http-request-smuggling-HTTP-1.1/">&lt; Bài đăng cũ hơn</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" Phân tích chuỗi Commons Collections 1 với LazyMap" href="/2022/12/15/CommonsCollections1-LazyMap/">Bài đăng mới hơn &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.webp" loading="lazy" decoding="auto">
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center">来年の事を言えば鬼が笑う</p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                Bài đăng
            </span>
            <span class="count">
                10
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                Thể loại
            </span>
            <span class="count">
                10
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                Thẻ
            </span>
            <span class="count">
                11
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class">
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        Thư mục bài viết
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-Command-Line"><span class="toc-text">Docker Command Line</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Thao-tac-voi-moi-lan-chay"><span class="toc-text">Thao tác với mỗi lần chạy:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#i-va-t-flag"><span class="toc-text">-i và -t flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-container-va-d-flag"><span class="toc-text">Docker container và -d flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%93name-flag"><span class="toc-text">–name flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#p-flag"><span class="toc-text">-p flag:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-log"><span class="toc-text">Docker log:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-pull"><span class="toc-text">Docker pull:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-commit"><span class="toc-text">Docker commit:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-build-command"><span class="toc-text">Docker build command</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-inspect"><span class="toc-text">Docker inspect:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Image-va-Container"><span class="toc-text">Gỡ Image và Container:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Go-container"><span class="toc-text">Gỡ container:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Go-image"><span class="toc-text">Gỡ image:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-Container%E2%80%99s-Filesystem"><span class="toc-text">Docker Container’s Filesystem</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-images-va-layers"><span class="toc-text">Docker images và layers:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-container-va-writable-layer"><span class="toc-text">Docker container và writable layer:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cach-build-mot-Docker-image"><span class="toc-text">Cách build một Docker image:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-Docker-Images-by-using-Docker-Commit-Command"><span class="toc-text">Build Docker Images by using Docker Commit Command:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-Docker-Images-by-writing-DockerFile"><span class="toc-text">Build Docker Images by writing DockerFile:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile-la-gi"><span class="toc-text">Dockerfile là gì?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Viet-mot-Dockerfile"><span class="toc-text">Viết một Dockerfile:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-RUN"><span class="toc-text">Câu lệnh RUN:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-CMD"><span class="toc-text">Câu lệnh CMD:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-cache"><span class="toc-text">Docker cache:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-COPY"><span class="toc-text">Câu lệnh COPY:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-ADD"><span class="toc-text">Câu lệnh ADD:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cau-lenh-WORKDIR"><span class="toc-text">Câu lệnh WORKDIR:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Xay-dung-Flask-web-don-gian-qua-Dockerfile"><span class="toc-text">Xây dựng Flask web đơn giản qua Dockerfile:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-Container-Links"><span class="toc-text">Docker Container Links:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-compose"><span class="toc-text">Docker compose</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>Thể loại</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/">DevOps</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/Docker/">Docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/Nginx/">Nginx</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/DevOps/Nginx/Docker/">Docker</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP-Request-Smuggling/">HTTP Request Smuggling</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Deserialization/">Deserialization</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Programming/">Programming</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/SQLi/">SQLi</a><span class="category-list-count">1</span></li></ul></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>Những thẻ hiện có</h4>
      <div class="tag-clouds">
        <a href="/tags/Commons-Collections/" style="font-size: 0.7em;">Commons Collections</a> <a href="/tags/Deserialization/" style="font-size: 0.75em;">Deserialization</a> <a href="/tags/DevOps/" style="font-size: 0.6em;">DevOps</a> <a href="/tags/Docker/" style="font-size: 0.65em;">Docker</a> <a href="/tags/HRS/" style="font-size: 0.6em;">HRS</a> <a href="/tags/Java/" style="font-size: 0.8em;">Java</a> <a href="/tags/Mysql/" style="font-size: 0.6em;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 0.6em;">Nginx</a> <a href="/tags/Programming/" style="font-size: 0.6em;">Programming</a> <a href="/tags/Reflection/" style="font-size: 0.6em;">Reflection</a> <a href="/tags/SQLi/" style="font-size: 0.6em;">SQLi</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>Bài viết gần đây</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2023/04/15/nginx-learning/"><i class="fa  fa-book"></i> Nginx Learning Journey</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/03/20/CommonsCollections3/"><i class="fa  fa-book"></i> Phân tích chuỗi Commons Collections 3</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/12/16/CommonsCollections2/"><i class="fa  fa-book"></i> Phân tích chuỗi Commons Collections 2</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/12/15/CommonsCollections1-LazyMap/"><i class="fa  fa-book"></i> Phân tích chuỗi Commons Collections 1 với LazyMap</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/12/03/docker-learning/"><i class="fa  fa-book"></i> Một bản ghi chép nhỏ về Docker</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer" class="ap-lrc">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        <li><a href="mailto:rayin.awarf@gmail.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope"></i></a></li>
                        <li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://t.me/rayinaw"><i class="fa fa-telegram"></i></a></li>
                        
                        
                        
                        
                        <li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/rayinaw"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2023 Rayinaw All rights reserved.</li>
                            <li>This site has been running for<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank" rel="external nofollow noopener noreferrer">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by Rayinaw.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank" rel="external nofollow noopener noreferrer">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js server="netease" type="playlist" id="3204190542" order="random" fixed="true">
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>